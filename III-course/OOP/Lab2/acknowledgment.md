I would like to offer my special thanks to @vitaliy1919 for basic logic and @damhuman for helping with generalized parsing method.